import pandas as pd
import matplotlib.pyplot as plt
from sklearn.preprocessing import StandardScaler
from sklearn.decomposition import PCA

# 游닌 Carregar apenas o DataFrame de poderes
powers_df = pd.read_csv("C:/Users/muril/Downloads/archive/super_hero_powers.csv")

# 游 Extrair a matriz de poderes (bin치ria: 0 ou 1)
X = powers_df.drop(columns=["hero_names"]).fillna(0)

# 游늺 Padronizar os dados
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# 游댵 Aplicar PCA
pca = PCA(n_components=2)
pca.fit(X_scaled)

# 游늵 Criar DataFrame com as contribui칞칫es dos poderes nos componentes
components_df = pd.DataFrame(
    data=pca.components_,
    columns=X.columns,
    index=["PCA1", "PCA2"]
).T

# 游댛 Selecionar os 10 poderes mais influentes em cada componente
top_pca1 = components_df["PCA1"].abs().sort_values(ascending=False).head(10)
top_pca2 = components_df["PCA2"].abs().sort_values(ascending=False).head(10)

# 游꿛 Plotar os gr치ficos
fig, axes = plt.subplots(1, 2, figsize=(14, 6))

top_pca1.plot(kind='barh', ax=axes[0], color='steelblue')
axes[0].set_title("Top 10 Poderes - PCA1")
axes[0].invert_yaxis()
axes[0].set_xlabel("Contribui칞칚o Absoluta")

top_pca2.plot(kind='barh', ax=axes[1], color='darkorange')
axes[1].set_title("Top 10 Poderes - PCA2")
axes[1].invert_yaxis()
axes[1].set_xlabel("Contribui칞칚o Absoluta")

# 游 Mostrar gr치fico
plt.tight_layout()
plt.show()
